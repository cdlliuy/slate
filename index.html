
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>App AutoScaler API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">shell</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#app-autoscaler" class="toc-h1 toc-link" data-title="App AutoScaler">App AutoScaler</a>
          </li>
          <li>
            <a href="#authentication" class="toc-h1 toc-link" data-title="Authentication">Authentication</a>
          </li>
          <li>
            <a href="#policy" class="toc-h1 toc-link" data-title="Policy">Policy</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#get-policy" class="toc-h2 toc-link" data-title="Get policy">Get policy</a>
                  </li>
                  <li>
                    <a href="#create-update-policy" class="toc-h2 toc-link" data-title="Create/Update policy">Create/Update policy</a>
                  </li>
                  <li>
                    <a href="#delete-policy" class="toc-h2 toc-link" data-title="Delete policy">Delete policy</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#metrics" class="toc-h1 toc-link" data-title="Metrics">Metrics</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#aggregated-metrics" class="toc-h2 toc-link" data-title="Aggregated Metrics">Aggregated Metrics</a>
                  </li>
                  <li>
                    <a href="#instances-metrics" class="toc-h2 toc-link" data-title="Instances Metrics">Instances Metrics</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#histories" class="toc-h1 toc-link" data-title="Histories">Histories</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#http-request-6" class="toc-h2 toc-link" data-title="HTTP Request">HTTP Request</a>
                  </li>
                  <li>
                    <a href="#query-parameters-3" class="toc-h2 toc-link" data-title="Query Parameters">Query Parameters</a>
                  </li>
              </ul>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><a href='https://github.com/cloudfoundry-incubator/app-autoscaler'>Cloud Foundry App Auto-Scaler</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='app-autoscaler'>App AutoScaler</h1>
<p>This topic explains how to use the App-AutoScaler with its RESTful API. </p>

<p>The App Autoscaler API allows you to manage <code>App Autoscaler</code> with <code>curl</code> from command line simply or in other programming approach. </p>

<p>If you access <code>App Autoscaler API</code> through <code>shell</code>, we assume you have installed [Cloud Foundry Command Line][a] which could be used to get Authentication token and Application guid related information. </p>
<h1 id='authentication'>Authentication</h1>
<blockquote>
<p>To get the authorization token, use this code:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="nv">token</span><span class="o">=</span><span class="sb">`</span>cf oauth-token<span class="sb">`</span>
curl <span class="s2">"api_endpoint_here"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization:</span><span class="nv">$token</span><span class="sb">`</span>  
</code></pre>
<p><code>App Autoscaler API</code> uses the <a href="https://github.com/cloudfoundry/uaa/blob/develop/docs/UAA-Tokens.md">Cloud Foundry User Token</a> to identify the user&#39;s information and only responses to the requests raised by authorized Space developers. </p>
<h1 id='policy'>Policy</h1><h2 id='get-policy'>Get policy</h2>
<blockquote>
<p>To get the AutoScaling policy of your application, please use the code below:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="nv">token</span><span class="o">=</span><span class="sb">`</span>cf oauth-token<span class="sb">`</span>
<span class="nv">appId</span><span class="o">=</span><span class="sb">`</span>cf app &lt;Your-App&gt; --guid<span class="sb">`</span>
curl <span class="s2">"http://example.com/v1/apps/</span><span class="nv">$appId</span><span class="s2">/policy"</span> <span class="se">\</span>
  -X GET <span class="se">\</span>
  -H <span class="s2">"Authorization:</span><span class="nv">$token</span><span class="sb">`</span> 
</code></pre>
<blockquote>
<p>Make sure to replace <code>Your-App</code> with your application name.</p>

<p>The above command returns JSON structured like this, which is built per <a href="/app-autoscaler/policy.html">App AutoScaler policy specification</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"instance_min_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="s2">"instance_max_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
  </span><span class="s2">"scaling_rules"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"metric_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"memoryutil"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"breach_duration_secs"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
      </span><span class="s2">"threshold"</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w">
      </span><span class="s2">"operator"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"cool_down_secs"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w">
      </span><span class="s2">"adjustment"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-1"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"metric_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"memoryutil"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"breach_duration_secs"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
      </span><span class="s2">"threshold"</span><span class="p">:</span><span class="w"> </span><span class="mi">90</span><span class="p">,</span><span class="w">
      </span><span class="s2">"operator"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&gt;="</span><span class="p">,</span><span class="w">
      </span><span class="s2">"cool_down_secs"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w">
      </span><span class="s2">"adjustment"</span><span class="p">:</span><span class="w"> </span><span class="s2">"+1"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"schedules"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"timezone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Asia/Shanghai"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"recurring_schedule"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="s2">"start_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10:00"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"end_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"18:00"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"days_of_week"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="mi">1</span><span class="p">,</span><span class="w">
          </span><span class="mi">2</span><span class="p">,</span><span class="w">
          </span><span class="mi">3</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"instance_min_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="s2">"instance_max_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
        </span><span class="s2">"initial_min_instance_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="s2">"start_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2099-06-27"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"end_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2099-07-23"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"start_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"11:00"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"end_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"19:30"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"days_of_month"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="mi">5</span><span class="p">,</span><span class="w">
          </span><span class="mi">15</span><span class="p">,</span><span class="w">
          </span><span class="mi">25</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"instance_min_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
        </span><span class="s2">"instance_max_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
        </span><span class="s2">"initial_min_instance_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"specific_date"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="s2">"start_date_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2099-06-02T10:00"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"end_date_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2099-06-15T13:59"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"instance_min_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="s2">"instance_max_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
        </span><span class="s2">"initial_min_instance_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="s2">"start_date_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2099-01-04T20:00"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"end_date_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2099-02-19T23:15"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"instance_min_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="s2">"instance_max_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
        </span><span class="s2">"initial_min_instance_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">


</span></code></pre>
<p>This endpoint retrieves the Auto-Scaling policy of your application. </p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET /v1/apps/:guid/policy</code></p>

<p>where <code>:guid</code> is the application&#39;s GUID. </p>
<h2 id='create-update-policy'>Create/Update policy</h2>
<blockquote>
<p>To create an AutoScaling policy to your application, please prepare a policy JSON according to <a href="/app-autoscaler/policy.html">App AutoScaler policy specification</a> first, then attach the policy with the code below: </p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="nv">token</span><span class="o">=</span><span class="sb">`</span>cf oauth-token<span class="sb">`</span>
<span class="nv">appId</span><span class="o">=</span><span class="sb">`</span>cf app Your-App --guid<span class="sb">`</span>
curl <span class="s2">"http://example.com/v1/apps/</span><span class="nv">$appId</span><span class="s2">/policy"</span> <span class="se">\</span>
  -X PUT <span class="se">\</span>
  -H <span class="s2">"Authorization:</span><span class="nv">$token</span><span class="sb">`</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -d @policy.json 
</code></pre>
<blockquote>
<p>Make sure to replace <code>Your-App</code> with your application name, also replace <code>policy.json</code> with your policy file. </p>

<p>If the policy content is written in valid schema, the example response is :</p>
</blockquote>
<pre class="highlight plaintext"><code>HTTP/1.1 200 OK
&lt;file contents&gt;
</code></pre>
<blockquote>
<p>If the policy content is invalid, the example response is :</p>
</blockquote>
<pre class="highlight plaintext"><code>HTTP/1.1 400 Bad Request
&lt;Error messages&gt;
</code></pre>
<p>This endpoint create/update the Auto-Scaling policy to your application. </p>
<h3 id='http-request-2'>HTTP Request</h3>
<p><code>PUT /v1/apps/:guid/policy</code></p>

<p>where <code>:guid</code> is the application&#39;s GUID. </p>

<aside class="notice">The request body should be a valid <a href='/app-autoscaler/policy.html'>App AutoScaler policy</a> </aside>
<h2 id='delete-policy'>Delete policy</h2>
<blockquote>
<p>To remove <code>App AutoScaler</code> from your application, you can delete the policy with the code below:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="nv">token</span><span class="o">=</span><span class="sb">`</span>cf oauth-token<span class="sb">`</span>
<span class="nv">appId</span><span class="o">=</span><span class="sb">`</span>cf app &lt;Your-App&gt; --guid<span class="sb">`</span>
curl <span class="s2">"http://example.com/v1/apps/</span><span class="nv">$appId</span><span class="s2">/policy"</span> <span class="se">\</span>
  -X DELETE <span class="se">\</span>
  -H <span class="s2">"Authorization:</span><span class="nv">$token</span><span class="sb">`</span> 
</code></pre>
<blockquote>
<p>Make sure to replace <code>Your-App</code> with your application name.</p>

<p>Example response is :</p>
</blockquote>
<pre class="highlight plaintext"><code>HTTP/1.1 200 OK
</code></pre>
<p>This endpoint delete the Auto-Scaling policy from your application. </p>
<h3 id='http-request-3'>HTTP Request</h3>
<p><code>DELETE /v1/apps/:guid/policy</code></p>

<p>where <code>:guid</code> is the application&#39;s GUID. </p>
<h1 id='metrics'>Metrics</h1><h2 id='aggregated-metrics'>Aggregated Metrics</h2>
<blockquote>
<p>To get historical aggreagated metrics of your application, please use the code below:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="nv">token</span><span class="o">=</span><span class="sb">`</span>cf oauth-token<span class="sb">`</span>
<span class="nv">appId</span><span class="o">=</span><span class="sb">`</span>cf app &lt;Your-App&gt; --guid<span class="sb">`</span>
curl <span class="s2">"http://example.com/v1/apps/</span><span class="nv">$appId</span><span class="s2">/aggregated_metric_histories/&lt;Metric-Type&gt;"</span> <span class="se">\</span>
  -X GET <span class="se">\</span>
  -H <span class="s2">"Authorization:</span><span class="nv">$token</span><span class="sb">`</span> 
</code></pre>
<blockquote>
<p>Make sure to replace <code>Your-App</code> with your application name, and replace the <code>Metric-Type</code> to one of the supported metric types. </p>

<p>The above command returns JSON Array like below:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="s2">"total_results"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
  </span><span class="s2">"total_pages"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="s2">"page"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="s2">"prev_url"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"next_url"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"resources"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"app_guid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"appId"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="mi">1494989539138350433</span><span class="p">,</span><span class="w">
      </span><span class="s2">"metric_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"memoryused"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"400"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"unit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"megabytes"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"app_guid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"appId"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="mi">1494989539138350433</span><span class="p">,</span><span class="w">
      </span><span class="s2">"metric_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"memoryused"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"400"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"unit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"megabytes"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>
<p>This endpoint retrieves the aggregated metrics of your application. </p>

<p><code>App AutoScaler</code> has more interests in the application’s aggregated average metric than individual instance metrics and use the aggregated metrics in evaluation stage.  So, querying the aggrgated metrics will help you to understand why a scaling action happens at that time.  </p>
<h3 id='http-request-4'>HTTP Request</h3>
<p><code>GET /v1/apps/:guid/aggregated_metric_histories/:&lt;Metric-Type&gt;</code>, in which </p>

<ul>
<li><code>:guid</code> is the application&#39;s GUID</li>
<li><code>:&lt;Metric-Type&gt;</code> is one of the supported metric type value, including 

<ul>
<li>memoryused </li>
<li>memoryutil</li>
<li>responsetime</li>
<li>throughput</li>
</ul></li>
</ul>
<h3 id='query-parameters'>Query Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Values</th>
<th>Required</th>
</tr>
</thead><tbody>
<tr>
<td>start-time</td>
<td>The start time</td>
<td>int, the number of nanoseconds elapsed since January 1, 1970 UTC</td>
<td>false, default 0</td>
</tr>
<tr>
<td>end-time</td>
<td>The end time</td>
<td>int, the number of nanoseconds elapsed since January 1, 1970 UTC</td>
<td>false, default <code>now</code></td>
</tr>
<tr>
<td>order</td>
<td>The order of display</td>
<td>string,”asc” or “desc”</td>
<td>false, default <code>desc</code></td>
</tr>
<tr>
<td>page</td>
<td>The required page number</td>
<td>int</td>
<td>false, default 1</td>
</tr>
<tr>
<td>results-per-page</td>
<td>Number of results which displayed in the same page</td>
<td>int</td>
<td>false, default 10</td>
</tr>
</tbody></table>
<h2 id='instances-metrics'>Instances Metrics</h2>
<blockquote>
<p>To get historical instance&#39;s metrics of your application, please use the code below:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="nv">token</span><span class="o">=</span><span class="sb">`</span>cf oauth-token<span class="sb">`</span>
<span class="nv">appId</span><span class="o">=</span><span class="sb">`</span>cf app &lt;Your-App&gt; --guid<span class="sb">`</span>
curl <span class="s2">"http://example.com/v1/apps/</span><span class="nv">$appId</span><span class="s2">/metric_histories/&lt;Metric-Type&gt;"</span> <span class="se">\</span>
  -X GET <span class="se">\</span>
  -H <span class="s2">"Authorization:</span><span class="nv">$token</span><span class="sb">`</span> 
</code></pre>
<blockquote>
<p>Make sure to replace <code>Your-App</code> with your application name, and replace the <code>Metric-Type</code> to one of the supported metric types. </p>

<p>The above command returns JSON Array like below:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="s2">"total_results"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
  </span><span class="s2">"total_pages"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="s2">"page"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="s2">"resources"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"app_guid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"appId"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"instanceIndex"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="s2">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="mi">1494989539138350433</span><span class="p">,</span><span class="w">
      </span><span class="s2">"collected_at"</span><span class="p">:</span><span class="w"> </span><span class="mi">1494989539138350000</span><span class="p">,</span><span class="w">
      </span><span class="s2">"metric_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"memoryused"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"400"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"unit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"megabytes"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"app_guid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"appId"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"instance_index"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="s2">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="mi">1494989539138350433</span><span class="p">,</span><span class="w">
      </span><span class="s2">"collected_at"</span><span class="p">:</span><span class="w"> </span><span class="mi">1494989539138350000</span><span class="p">,</span><span class="w">
      </span><span class="s2">"metric_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"memoryused"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"400"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"unit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"megabytes"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>
<p>This endpoint retrieves the instance&#39;s metrics of your application. </p>
<h3 id='http-request-5'>HTTP Request</h3>
<p><code>GET /v1/apps/:guid/metric_histories/:&lt;Metric-Type&gt;</code>, in which </p>

<ul>
<li><code>:guid</code> is the application&#39;s GUID</li>
<li><code>:&lt;Metric-Type&gt;</code> is one of the supported metric type value, including 

<ul>
<li>memoryused </li>
<li>memoryutil</li>
<li>responsetime</li>
<li>throughput</li>
</ul></li>
</ul>
<h3 id='query-parameters-2'>Query Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Values</th>
<th>Required</th>
</tr>
</thead><tbody>
<tr>
<td>start-time</td>
<td>The start time</td>
<td>int, the number of nanoseconds elapsed since January 1, 1970 UTC</td>
<td>false, default 0</td>
</tr>
<tr>
<td>end-time</td>
<td>The end time</td>
<td>int, the number of nanoseconds elapsed since January 1, 1970 UTC</td>
<td>false, default <code>now</code></td>
</tr>
<tr>
<td>order</td>
<td>The order of display</td>
<td>string,”asc” or “desc”</td>
<td>false, default <code>desc</code></td>
</tr>
<tr>
<td>page</td>
<td>The required page number</td>
<td>int</td>
<td>false, default 1</td>
</tr>
<tr>
<td>results-per-page</td>
<td>Number of results which displayed in the same page</td>
<td>int</td>
<td>false, default 10</td>
</tr>
</tbody></table>
<h1 id='histories'>Histories</h1>
<blockquote>
<p>To get the autoscaling histories of your application, please use the code below:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="nv">token</span><span class="o">=</span><span class="sb">`</span>cf oauth-token<span class="sb">`</span>
<span class="nv">appId</span><span class="o">=</span><span class="sb">`</span>cf app &lt;Your-App&gt; --guid<span class="sb">`</span>
curl <span class="s2">"http://example.com/v1/apps/</span><span class="nv">$appId</span><span class="s2">/scaling_histories"</span> <span class="se">\</span>
  -X GET <span class="se">\</span>
  -H <span class="s2">"Authorization:</span><span class="nv">$token</span><span class="sb">`</span> 
</code></pre>
<blockquote>
<p>Make sure to replace <code>Your-App</code> with your application name.</p>

<p>The above command returns JSON Array like below:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"total_results"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
  </span><span class="s2">"total_pages"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="s2">"page"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="s2">"resources"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"app_guid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"appId"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="mi">1494989539138350433</span><span class="p">,</span><span class="w">
      </span><span class="s2">"scaling_type"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="s2">"old_instances"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="s2">"new_instances"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
      </span><span class="s2">"reason"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
      </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
      </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"app_guid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"appId"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="mi">1494989539138350435</span><span class="p">,</span><span class="w">
      </span><span class="s2">"scaling_type"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="s2">"old_instances"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="s2">"new_instances"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
      </span><span class="s2">"reason"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
      </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
      </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint retrieves the autoscaling history events of your application for audit purpose.</p>
<h3 id='http-request-6'>HTTP Request</h3>
<p><code>GET /v1/apps/:guid/scaling_histories</code></p>

<p>where <code>:guid</code> is the application&#39;s GUID</p>
<h3 id='query-parameters-3'>Query Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Values</th>
<th>Required</th>
</tr>
</thead><tbody>
<tr>
<td>start-time</td>
<td>The start time</td>
<td>int, the number of nanoseconds elapsed since January 1, 1970 UTC</td>
<td>false, default 0</td>
</tr>
<tr>
<td>end-time</td>
<td>The end time</td>
<td>int, the number of nanoseconds elapsed since January 1, 1970 UTC</td>
<td>false, default <code>now</code></td>
</tr>
<tr>
<td>order</td>
<td>The order of display</td>
<td>string,”asc” or “desc”</td>
<td>false, default <code>desc</code></td>
</tr>
<tr>
<td>page</td>
<td>The required page number</td>
<td>int</td>
<td>false, default 1</td>
</tr>
<tr>
<td>results-per-page</td>
<td>Number of results which displayed in the same page</td>
<td>int</td>
<td>false, default 10</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
          </div>
      </div>
    </div>
  </body>
</html>
